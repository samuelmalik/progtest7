#include <ctype.h>
#include <stdio.h>
#include <string.h>

int readNumbers(char *input) {
    if (scanf("%13s", input) != 1) return 1;
    const unsigned long long len = strlen(input);
    if (len > 12) return 1;
    for (unsigned long long i = 0; i<len; i++) {
        if (!isdigit(input[i])) return 1;
    }
    return 0;
}

int readResult(int *result, char* requestType) {
    char c;
    int res = scanf(" %c %d%c",requestType, result,&c);
    printf("C: \"%c\"\n", c);
    if (res == EOF) return -1;
    if (res != 3 || (*requestType!='?' && *requestType!='#') || c!='\n') return 1;
    return 0;
}

void findAllCombinations(char *beginning, char *rest) {
    if (strlen(rest) == 2) {
        printf("%s%c+%c\n", beginning, rest[0], rest[1]);
        printf("%s%c-%c\n", beginning, rest[0], rest[1]);
        printf("%s%c*%c\n", beginning, rest[0], rest[1]);
        printf("%s%c%c\n", beginning, rest[0], rest[1]);
    } else {
        char tmp[25];
        strncpy(tmp, beginning, 2);
        unsigned long beginningLen = strlen(tmp);

        // scitanie
        tmp[beginningLen] = rest[0];
        tmp[beginningLen+1] = '+';
        tmp[beginningLen+2] = '\0';
        printf("Doterajsi string: %s\n", tmp);
        printf("Zbytok: %s\n", rest+1);
        findAllCombinations(tmp, rest+1);

        // odcitanie
        tmp[beginningLen+1] = '-';
        tmp[beginningLen+2] = '\0';
        printf("Doterajsi string: %s\n", tmp);
        printf("Zbytok: %s\n", rest+1);

        // nasobenie
        tmp[beginningLen+1] = '*';
        tmp[beginningLen+2] = '\0';
        printf("Doterajsi string: %s\n", tmp);
        printf("Zbytok: %s\n", rest+1);

        // medzera
        tmp[beginningLen+1] = '\0';
        printf("Doterajsi string: %s\n", tmp);
        printf("Zbytok: %s\n", rest+1);


        //printf("DEBUG: %s\n", tmp);
        //printf("STRLEN: %lu\n", strlen(tmp));
        //findAllCombinations(, rest+1);
    }
};

int main(void) {
    // premenne
    char requestType, input[14];
    int result;

    // Nacitanie cislic
    printf("Cislice:\n");
    if (readNumbers(input)) {
        printf("Nespravny vstup.");
        return 1;
    }

    // Nacitanie a spracovanie problemov
    printf("Problemy:\n");
    int scanRes;
    while ((scanRes = readResult(&result, &requestType))==0) {
        // Debug vypis
        printf("===========\nZadane cisla %s\n", input);
        printf("Vysledok %d\n", result);
        printf("Typ: %c\n\n", requestType);

        // Funkcia na spracovanie vstupov
        char test[2]="";
        findAllCombinations(test, input);
    }
    if (scanRes != -1) {
        printf("Nespravny vstup.");
        return 1;
    }
    return 0;
}
